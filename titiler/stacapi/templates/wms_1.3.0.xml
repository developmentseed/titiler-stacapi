<?xml version="1.0" encoding="UTF-8"?>
<WMS_Capabilities
  xmlns="http://www.opengis.net/wms"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  updateSequence="1291"
  version="1.3.0"
  xsi:schemaLocation="http://www.opengis.net/wms http://geo.ipt.br:8080/geoserver/schemas/wms/1.3.0/capabilities_1_3_0.xsd">
  <Service>
    <Name>OGC:WMS</Name>
    <Title>titiler-stacapi OGC WMS</Title>
  </Service>
  <Capability>
    <Request>
      <GetCapabilities>
        <Format>text/xml</Format>
        <DCPType>
          <HTTP>
            <Get><OnlineResource xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{{ request_url }}"/></Get>
          </HTTP>
        </DCPType>
      </GetCapabilities>
      <GetMap>
        {% for format in formats %}
        <Format>{{format}}</Format>
        {% endfor %}
        <DCPType>
          <HTTP>
            <Get><OnlineResource xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{{ request_url }}"/></Get>
          </HTTP>
        </DCPType>
      </GetMap>
      <GetFeatureInfo>
        <Format>text/html</Format>
        <DCPType>
          <HTTP>
            <Get><OnlineResource xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{{ request_url }}"/></Get>
          </HTTP>
        </DCPType>
      </GetFeatureInfo>
    </Request>
    <Exception>
      <Format>XML</Format>
      <Format>INIMAGE</Format>
      <Format>BLANK</Format>
    </Exception>
    {% for id, values in layers_dict.items() %}
    <Layer queryable="1" opaque="0" cascaded="0">
        <Name>{{id}}</Name>
        <Title>{{id}}</Title>
        <Abstract>{{values['abstract']}}</Abstract>
        {% for crs in available_epsgs %}
        <CRS>{{crs}}</CRS>
        {% endfor %}
        {% if values.time %}
        <Dimension name="TIME" multipleValues="true" current="true" default="{{ values.time[-1] }}">
          {{ ','.join(values.time) }}
        </Dimension>
        {% endif %}
        <EX_GeographicBoundingBox>
            <westBoundLongitude>{{values['bounds_wgs84'][0]}}</westBoundLongitude>
            <eastBoundLongitude>{{values['bounds_wgs84'][2]}}</eastBoundLongitude>
            <southBoundLatitude>{{values['bounds_wgs84'][1]}}</southBoundLatitude>
            <northBoundLatitude>{{values['bounds_wgs84'][3]}}</northBoundLatitude>
        </EX_GeographicBoundingBox>
        <BoundingBox CRS="CRS:84" minx="{{values['bounds_wgs84'][0]}}" miny="{{values['bounds_wgs84'][1]}}" maxx="{{values['bounds_wgs84'][2]}}" maxy="{{values['bounds_wgs84'][3]}}"/>
        <BoundingBox CRS="{{values['srs']}}" minx="{{values['bounds'][1]}}" miny="{{values['bounds'][0]}}" maxx="{{values['bounds'][3]}}" maxy="{{values['bounds'][2]}}"/>
    </Layer>
    {% endfor %}
  </Capability>
</WMS_Capabilities>
